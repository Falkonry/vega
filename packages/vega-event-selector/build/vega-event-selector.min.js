!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).vega={})}(this,(function(t){"use strict";const e="[",n="]",r="{",i="}",o=":",s=",",c="@",l=">",f=/[[\]{}]/,u={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let h,a;function p(t,e,n,r,i){const o=t.length;let s,c=0;for(;e<o;++e){if(s=t[e],!c&&s===n)return e;i&&i.indexOf(s)>=0?--c:r&&r.indexOf(s)>=0&&++c}return e}function m(t){const o=[],c=t.length;let l=0,f=0;for(;f<c;)f=p(t,f,s,e+r,n+i),o.push(t.substring(l,f).trim()),l=++f;if(0===o.length)throw"Empty event selector: "+t;return o}function g(t){return"["===t[0]?function(t){const r=t.length;let i,o=1;if(o=p(t,o,n,e,n),o===r)throw"Empty between selector: "+t;if(i=m(t.substring(1,o)),2!==i.length)throw"Between selector must have two elements: "+t;if(t=t.slice(o+1).trim(),t[0]!==l)throw"Expected '>' after between selector: "+t;i=i.map(g);const s=g(t.slice(1).trim());if(s.between)return{between:i,stream:s};s.between=i;return s}(t):function(t){const l={source:h},u=[];let m,g,b=[0,0],w=0,d=0,y=t.length,x=0;if(t[y-1]===i){if(x=t.lastIndexOf(r),!(x>=0))throw"Unmatched right brace: "+t;try{b=function(t){const e=t.split(s);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(x+1,y-1))}catch(e){throw"Invalid throttle specification: "+t}y=(t=t.slice(0,x).trim()).length,x=0}if(!y)throw t;t[0]===c&&(w=++x);m=p(t,x,o),m<y&&(u.push(t.substring(d,m).trim()),d=x=++m);if(x=p(t,x,e),x===y)u.push(t.substring(d,y).trim());else if(u.push(t.substring(d,x).trim()),g=[],d=++x,d===y)throw"Unmatched left bracket: "+t;for(;x<y;){if(x=p(t,x,n),x===y)throw"Unmatched left bracket: "+t;if(g.push(t.substring(d,x).trim()),x<y-1&&t[++x]!==e)throw"Expected left bracket: "+t;d=++x}if(!(y=u.length)||f.test(u[y-1]))throw"Invalid event selector: "+t;y>1?(l.type=u[1],w?l.markname=u[0].slice(1):(v=u[0],a[v]?l.marktype=u[0]:l.source=u[0])):l.type=u[0];var v;"!"===l.type.slice(-1)&&(l.consume=!0,l.type=l.type.slice(0,-1));null!=g&&(l.filter=g);b[0]&&(l.throttle=b[0]);b[1]&&(l.debounce=b[1]);return l}(t)}t.parseSelector=function(t,e,n){return h=e||"view",a=n||u,m(t.trim()).map(g)}}));
//# sourceMappingURL=vega-event-selector.min.js.map
